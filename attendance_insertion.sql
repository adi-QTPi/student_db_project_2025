use student_db3;

-- First, verify that all required students exist
SELECT COUNT(*) INTO @student_count 
FROM Student 
WHERE enrollment_number IN (
    23001001, 23001002, 23002001, 23002002, 23003001, 
    24117007, 23006001, 23007001, 23008001, 23009001, 23010001
);

-- Then, verify that all required courses exist
SELECT COUNT(*) INTO @course_count 
FROM Courses 
WHERE course_id IN (
    'CS101', 'CS102', 'EE101', 'EE201', 'ME101', 'ME201',
    'MAC104', 'MAC102', 'MAC106', 'DSAI101', 'DSAI102',
    'ECE101', 'ECE201', 'META101', 'META201', 'EPH101',
    'EPH201', 'CHE101', 'CHE201', 'HSS101', 'HSS102'
);

-- Only proceed with insertion if all required data exists
SET @total_required = 11; -- number of students
SET @total_courses = 21;  -- number of courses

-- Insert data into Attendance table only if all required data exists
INSERT INTO Attendance (enrollment_number, course_id, date_time)
SELECT a.* FROM (
    -- Computer Science Students (2023 batch)
    SELECT 23001001 as enrollment_number, 'CS101' as course_id, '2023-08-01 09:00:00' as date_time
    UNION ALL SELECT 23001001, 'CS101', '2023-08-03 09:00:00'
    UNION ALL SELECT 23001001, 'CS101', '2023-08-08 09:00:00'
    UNION ALL SELECT 23001001, 'CS102', '2023-08-02 11:00:00'
    UNION ALL SELECT 23001001, 'CS102', '2023-08-04 11:00:00'
    UNION ALL SELECT 23001001, 'CS102', '2023-08-09 11:00:00'
    UNION ALL SELECT 23001001, 'HSS101', '2023-08-01 14:00:00'
    UNION ALL SELECT 23001001, 'HSS101', '2023-08-03 14:00:00'

    UNION ALL SELECT 23001002, 'CS101', '2023-08-01 09:00:00'
    UNION ALL SELECT 23001002, 'CS101', '2023-08-03 09:00:00'
    UNION ALL SELECT 23001002, 'CS102', '2023-08-02 11:00:00'
    UNION ALL SELECT 23001002, 'CS102', '2023-08-04 11:00:00'
    UNION ALL SELECT 23001002, 'HSS102', '2023-08-02 14:00:00'
    UNION ALL SELECT 23001002, 'HSS102', '2023-08-04 14:00:00'

    -- Electrical Engineering Students (2023 batch)
    UNION ALL SELECT 23002001, 'EE101', '2023-08-01 10:00:00'
    UNION ALL SELECT 23002001, 'EE101', '2023-08-03 10:00:00'
    UNION ALL SELECT 23002001, 'EE101', '2023-08-08 10:00:00'
    UNION ALL SELECT 23002001, 'EE201', '2023-08-02 13:00:00'
    UNION ALL SELECT 23002001, 'EE201', '2023-08-04 13:00:00'
    UNION ALL SELECT 23002001, 'HSS101', '2023-08-01 14:00:00'
    UNION ALL SELECT 23002001, 'HSS101', '2023-08-03 14:00:00'

    UNION ALL SELECT 23002002, 'EE101', '2023-08-01 10:00:00'
    UNION ALL SELECT 23002002, 'EE101', '2023-08-03 10:00:00'
    UNION ALL SELECT 23002002, 'EE201', '2023-08-02 13:00:00'
    UNION ALL SELECT 23002002, 'EE201', '2023-08-04 13:00:00'
    UNION ALL SELECT 23002002, 'HSS102', '2023-08-02 14:00:00'
    UNION ALL SELECT 23002002, 'HSS102', '2023-08-04 14:00:00'

    -- Mechanical Engineering Students (2023 batch)
    UNION ALL SELECT 23003001, 'ME101', '2023-08-02 09:00:00'
    UNION ALL SELECT 23003001, 'ME101', '2023-08-04 09:00:00'
    UNION ALL SELECT 23003001, 'ME101', '2023-08-09 09:00:00'
    UNION ALL SELECT 23003001, 'ME201', '2023-08-01 11:00:00'
    UNION ALL SELECT 23003001, 'ME201', '2023-08-03 11:00:00'
    UNION ALL SELECT 23003001, 'HSS101', '2023-08-01 14:00:00'
    UNION ALL SELECT 23003001, 'HSS101', '2023-08-03 14:00:00'

    -- Mathematics and Computing Students (2024 batch)
    UNION ALL SELECT 24117007, 'MAC104', '2024-01-15 09:00:00'
    UNION ALL SELECT 24117007, 'MAC104', '2024-01-17 09:00:00'
    UNION ALL SELECT 24117007, 'MAC104', '2024-01-22 09:00:00'
    UNION ALL SELECT 24117007, 'MAC102', '2024-01-16 11:00:00'
    UNION ALL SELECT 24117007, 'MAC102', '2024-01-18 11:00:00'
    UNION ALL SELECT 24117007, 'MAC106', '2024-01-15 14:00:00'
    UNION ALL SELECT 24117007, 'MAC106', '2024-01-17 14:00:00'
    UNION ALL SELECT 24117007, 'HSS101', '2024-01-16 15:00:00'
    UNION ALL SELECT 24117007, 'HSS101', '2024-01-18 15:00:00'
    UNION ALL SELECT 24117007, 'HSS102', '2024-01-15 16:00:00'
    UNION ALL SELECT 24117007, 'HSS102', '2024-01-17 16:00:00'

    -- Data Science and AI Students (2023 batch)
    UNION ALL SELECT 23006001, 'DSAI101', '2023-08-02 10:00:00'
    UNION ALL SELECT 23006001, 'DSAI101', '2023-08-04 10:00:00'
    UNION ALL SELECT 23006001, 'DSAI101', '2023-08-09 10:00:00'
    UNION ALL SELECT 23006001, 'DSAI102', '2023-08-01 13:00:00'
    UNION ALL SELECT 23006001, 'DSAI102', '2023-08-03 13:00:00'
    UNION ALL SELECT 23006001, 'HSS101', '2023-08-01 14:00:00'
    UNION ALL SELECT 23006001, 'HSS101', '2023-08-03 14:00:00'

    -- Electronics and Communication Students (2023 batch)
    UNION ALL SELECT 23007001, 'ECE101', '2023-08-01 11:00:00'
    UNION ALL SELECT 23007001, 'ECE101', '2023-08-03 11:00:00'
    UNION ALL SELECT 23007001, 'ECE101', '2023-08-08 11:00:00'
    UNION ALL SELECT 23007001, 'ECE201', '2023-08-02 14:00:00'
    UNION ALL SELECT 23007001, 'ECE201', '2023-08-04 14:00:00'
    UNION ALL SELECT 23007001, 'HSS102', '2023-08-02 15:00:00'
    UNION ALL SELECT 23007001, 'HSS102', '2023-08-04 15:00:00'

    -- Metallurgical Engineering Students (2023 batch)
    UNION ALL SELECT 23008001, 'META101', '2023-08-02 09:00:00'
    UNION ALL SELECT 23008001, 'META101', '2023-08-04 09:00:00'
    UNION ALL SELECT 23008001, 'META101', '2023-08-09 09:00:00'
    UNION ALL SELECT 23008001, 'META201', '2023-08-01 11:00:00'
    UNION ALL SELECT 23008001, 'META201', '2023-08-03 11:00:00'
    UNION ALL SELECT 23008001, 'HSS101', '2023-08-01 14:00:00'
    UNION ALL SELECT 23008001, 'HSS101', '2023-08-03 14:00:00'

    -- Engineering Physics Students (2023 batch)
    UNION ALL SELECT 23009001, 'EPH101', '2023-08-01 10:00:00'
    UNION ALL SELECT 23009001, 'EPH101', '2023-08-03 10:00:00'
    UNION ALL SELECT 23009001, 'EPH101', '2023-08-08 10:00:00'
    UNION ALL SELECT 23009001, 'EPH201', '2023-08-02 13:00:00'
    UNION ALL SELECT 23009001, 'EPH201', '2023-08-04 13:00:00'
    UNION ALL SELECT 23009001, 'HSS102', '2023-08-02 14:00:00'
    UNION ALL SELECT 23009001, 'HSS102', '2023-08-04 14:00:00'

    -- Chemical Engineering Students (2023 batch)
    UNION ALL SELECT 23010001, 'CHE101', '2023-08-02 09:00:00'
    UNION ALL SELECT 23010001, 'CHE101', '2023-08-04 09:00:00'
    UNION ALL SELECT 23010001, 'CHE101', '2023-08-09 09:00:00'
    UNION ALL SELECT 23010001, 'CHE201', '2023-08-01 11:00:00'
    UNION ALL SELECT 23010001, 'CHE201', '2023-08-03 11:00:00'
    UNION ALL SELECT 23010001, 'HSS101', '2023-08-01 14:00:00'
    UNION ALL SELECT 23010001, 'HSS101', '2023-08-03 14:00:00'
) a
WHERE @student_count = @total_required 
AND @course_count = @total_courses
AND EXISTS (
    SELECT 1 FROM Student s 
    WHERE s.enrollment_number = a.enrollment_number
)
AND EXISTS (
    SELECT 1 FROM Courses c 
    WHERE c.course_id = a.course_id
); 